# feat(proxy): route all network I/O via SOCKS5 (env-driven, default 127.0.0.1:1080); unify yt-dlp/Telegram/HTTP clients; add self-test and docs

## üåê –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø—Ä–æ–∫—Å–∏

### –ù–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ .env
- –î–æ–±–∞–≤–ª–µ–Ω `env.example` —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ø—Ä–æ–∫—Å–∏
- –°–æ–∑–¥–∞–Ω `config/proxy.go` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–∫—Å–∏
- –û–±–Ω–æ–≤–ª–µ–Ω `config/config.go` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ø—Ä–æ–∫—Å–∏
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: `USE_PROXY`, `PROXY_URL`, `NO_PROXY`

### –ï–¥–∏–Ω–∞—è —Å—Ö–µ–º–∞ –ø—Ä–æ–∫—Å–∏ –¥–ª—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **yt-dlp**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç `--proxy` –∞—Ä–≥—É–º–µ–Ω—Ç
- **HTTP –∫–ª–∏–µ–Ω—Ç—ã**: –ò—Å–ø–æ–ª—å–∑—É—é—Ç `http.Transport` —Å –ø—Ä–æ–∫—Å–∏
- **Telegram API**: HTTP –∫–ª–∏–µ–Ω—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å –ø—Ä–æ–∫—Å–∏
- **curl –∫–æ–º–∞–Ω–¥—ã**: –í—Å–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø—Ä–æ–∫—Å–∏

### –ê–Ω—Ç–∏-429 –∑–∞—â–∏—Ç–∞
- –î–æ–±–∞–≤–ª–µ–Ω—ã –∑–∞–¥–µ—Ä–∂–∫–∏ –¥–ª—è yt-dlp: `--sleep-requests 1 --sleep-interval 1 --max-sleep-interval 3`
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –æ—Ç YouTube

## üß™ –°–∞–º–æ–ø—Ä–æ–≤–µ—Ä–∫–∞

### –ù–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
- `scripts/selftest.go` - Go —Å–∫—Ä–∏–ø—Ç —Å–∞–º–æ–ø—Ä–æ–≤–µ—Ä–∫–∏
- `scripts/run_selftest.sh` - Bash —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞
- `quick_start_proxy.sh` - –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ —Å –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏

### –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–∫—Å–∏ –∏–∑ .env
- ‚úÖ HTTP –∫–ª–∏–µ–Ω—Ç —Å –ø—Ä–æ–∫—Å–∏
- ‚úÖ yt-dlp —Å –ø—Ä–æ–∫—Å–∏
- ‚úÖ curl —Å –ø—Ä–æ–∫—Å–∏
- ‚úÖ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã
- `README_PROXY.md` - –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –ø—Ä–æ–∫—Å–∏
- `README_FINAL.md` - –ò—Ç–æ–≥–æ–≤–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- `README_INSTALL.md` - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- `README.md` - –î–æ–±–∞–≤–ª–µ–Ω —Ä–∞–∑–¥–µ–ª –æ –ø—Ä–æ–∫—Å–∏
- –£–¥–∞–ª–µ–Ω—ã —Å—Ç–∞—Ä—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ VLESS

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –ø—Ä–æ–∫—Å–∏
- `socks5h://127.0.0.1:1080` - SOCKS5 —Å DNS —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- `socks5://127.0.0.1:1080` - SOCKS5 –±–µ–∑ DNS —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏
- `http://127.0.0.1:8080` - HTTP –ø—Ä–æ–∫—Å–∏
- `https://127.0.0.1:8080` - HTTPS –ø—Ä–æ–∫—Å–∏

### –ò—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–∫—Å–∏
- `localhost`, `127.0.0.1`
- `172.16.0.0/12`, `192.168.0.0/16`

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫
1. `PROXY_URL` (–Ω–æ–≤—ã–π)
2. `ALL_PROXY` (—Å—Ç–∞—Ä—ã–π)
3. `HTTP_PROXY` (—Å—Ç–∞—Ä—ã–π)
4. `HTTPS_PROXY` (—Å—Ç–∞—Ä—ã–π)
5. `SOCKS_PROXY` (—Å—Ç–∞—Ä—ã–π)

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
```bash
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞
cp env.example .env
nano .env  # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ USE_PROXY=true –∏ PROXY_URL=socks5h://127.0.0.1:1080

# –ó–∞–ø—É—Å–∫
./quick_start_proxy.sh
```

### –°–∞–º–æ–ø—Ä–æ–≤–µ—Ä–∫–∞
```bash
./scripts/run_selftest.sh
```

### –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–æ–∫—Å–∏
```env
# –í .env —Ñ–∞–π–ª–µ
USE_PROXY=false
```

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

- ‚úÖ –í—Å–µ —Å–µ—Ç–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∏–¥—É—Ç —á–µ—Ä–µ–∑ SOCKS5 –ø—Ä–æ–∫—Å–∏
- ‚úÖ yt-dlp –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ–∫—Å–∏ —Å –∞–Ω—Ç–∏-429 –∑–∞—â–∏—Ç–æ–π
- ‚úÖ Telegram API —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏
- ‚úÖ HTTP –∫–ª–∏–µ–Ω—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –µ–¥–∏–Ω—É—é —Å—Ö–µ–º—É
- ‚úÖ –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Å–∞–º–æ–ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ –ü—Ä–æ—Å—Ç–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ .env

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –ü—Ä–æ–∫—Å–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ (127.0.0.1)
- –ù–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–æ—Ä—Ç—ã –Ω–∞—Ä—É–∂—É
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç SOCKS5 –¥–ª—è –æ–±—Ö–æ–¥–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
- DNS –∑–∞–ø—Ä–æ—Å—ã –∏–¥—É—Ç —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏ (socks5h)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∞–Ω—Ç–∏-429 –∑–∞–¥–µ—Ä–∂–∫–∏
